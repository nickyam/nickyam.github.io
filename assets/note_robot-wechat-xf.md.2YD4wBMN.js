import{_ as a,o as e,c as n,R as s}from"./chunks/framework.qZlbAeHE.js";const m=JSON.parse('{"title":"无须服务器，五分钟部署公众号机器人","description":"","frontmatter":{},"headers":[],"relativePath":"note/robot-wechat-xf.md","filePath":"note/robot-wechat-xf.md","lastUpdated":null}'),p={name:"note/robot-wechat-xf.md"},t=s(`<h1 id="无须服务器-五分钟部署公众号机器人" tabindex="-1">无须服务器，五分钟部署公众号机器人 <a class="header-anchor" href="#无须服务器-五分钟部署公众号机器人" aria-label="Permalink to &quot;无须服务器，五分钟部署公众号机器人&quot;">​</a></h1><p>在公众号部署一个机器人，能够让微信公众号更加生动活泼，也能够帮助更多的读者。</p><p>感谢 @LuhangRui 的 项目，可以通过vercel的serverless服务，把星火认知大模型接入微信公众号。</p><p>以下是个人的实现过程。</p><h2 id="星火大模型" tabindex="-1">星火大模型 <a class="header-anchor" href="#星火大模型" aria-label="Permalink to &quot;星火大模型&quot;">​</a></h2><p>登录<a href="https://xinghuo.xfyun.cn/sparkapi" target="_blank" rel="noreferrer">星火大模型</a> 官网，注册账号点击免费使用。</p><p><strong>每个人通过实名认证后领取两百万星火 V3 的 token 大礼包，有效期一年。</strong></p><p><img src="https://img.nickyam.com/file/791b90d692cbc51aeb291.png" alt=""></p><p>进入服务管理页面，获取 APPID、APISecret、APIKey 三个参数内容。</p><p><img src="https://img.nickyam.com/file/5b93a4e263d817dada591.jpg" alt=""></p><h2 id="购买并解析域名" tabindex="-1">购买并解析域名 <a class="header-anchor" href="#购买并解析域名" aria-label="Permalink to &quot;购买并解析域名&quot;">​</a></h2><p>推荐购买 .xyz 后缀的域名，现在6位数字的，7元/年，续费不涨价。10年只需要70元。</p><p>设置 cname 解析到 cname.vercel-dns.com。</p><h2 id="设置微信公众号" tabindex="-1">设置微信公众号 <a class="header-anchor" href="#设置微信公众号" aria-label="Permalink to &quot;设置微信公众号&quot;">​</a></h2><p>在后台管理页面上找到：设置与开发-基本配置-服务器配置，修改：</p><ul><li><p>url：内容为 <a href="https://xn--6qqv7i2xdt95b/api/spark-wechat%EF%BC%9B" target="_blank" rel="noreferrer">https://你的域名/api/spark-wechat；</a></p></li><li><p>token：为前面项目配置中设置的参数；</p></li><li><p>EncodingAESKey：点击后面的随机生成即可；</p></li><li><p>消息加解密方式：选择明文模式；</p></li></ul><h2 id="部署-vercel" tabindex="-1">部署 Vercel <a class="header-anchor" href="#部署-vercel" aria-label="Permalink to &quot;部署 Vercel&quot;">​</a></h2><p>Fork <a href="https://github.com/LuhangRui/spark-wechat-vercel" target="_blank" rel="noreferrer">@LuhangRui 的项目</a> 到自己的仓库，访问<a href="https://vercel.com/" target="_blank" rel="noreferrer">Vercel</a> 使用github账号登录。</p><p>点击创建新项目,选择 Import Git Repository，从Github仓库导入。</p><p>在Environment Variables选项卡，增加环境变量。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>#这是v3版本星火大模型的请求地址，如果请求v2,v1.5修改HOST_URL、SPARK_DOMAIN这两项即可</span></span>
<span class="line"><span>#v1.5 地址：ws(s)://spark-api.xf-yun.com/v1.1/chat DOMAIN:general</span></span>
<span class="line"><span>#V2 地址：ws(s)://spark-api.xf-yun.com/v2.1/chat DOMAIN:generalv2</span></span>
<span class="line"><span>HOST_URL=wss://spark-api.xf-yun.com/v3.1/chat</span></span>
<span class="line"><span>SPARK_DOMAIN=generalv3</span></span>
<span class="line"><span>APPID=星火appid</span></span>
<span class="line"><span>API_SECRET=星火appsecret</span></span>
<span class="line"><span>API_KEY=星火apikey</span></span>
<span class="line"><span>WX_TOKEN=微信公众号TOKEN(3-32位字母随便编但要记住一会要用)</span></span>
<span class="line"><span>#这一项是关键词自动回复，是个json串，用于对特定关键词回复不同内容</span></span>
<span class="line"><span>KEYWORD_REPLAY={&quot;聊天记录&quot;:&quot;测试一下&quot;}</span></span>
<span class="line"><span>SUBSCRIBE_REPLY=欢迎关注，我已经接入了星火认知大模型。</span></span></code></pre></div><p>填完后，点击Deploy，等待部署完成后，点击 settings 找到 Domain ，把你的域名填上去就好了，会自动加https。</p><p>回到微信后台的服务器配置界面，点击提交，不出意外会提示token验证成功。</p><p>返回上一层，点击启用服务器配置。现在你有一个接入星火认知大模型的微信公众号聊天机器人了。</p>`,24),r=[t];function l(i,o,c,h,d,u){return e(),n("div",null,r)}const b=a(p,[["render",l]]);export{m as __pageData,b as default};
